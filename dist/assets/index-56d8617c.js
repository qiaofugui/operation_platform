import{b3 as k,a as Y,N as Z,r as s,o as ee,P as ae,f as b,s as le,y as a,w as o,k as oe,g as T,Q as v,p as te,j as re,h as C,am as V,b5 as m,b0 as se,R as ne,S as de,E as ie,U as ue,V as ce}from"./index-e08de63f.js";import{E as me}from"./el-dialog-50992940.js";import"./el-overlay-67364692.js";import{E as pe}from"./el-progress-7004bc52.js";/* empty css                */import{E as _e}from"./el-pagination-c9de229a.js";import{a as fe,E as ve,b as ge,v as be}from"./el-badge-4c3e83dc.js";/* empty css                   */import{E as ke}from"./el-button-d2944afa.js";import{E as Ee}from"./el-image-viewer-6875afb8.js";import{_ as Ue}from"./plus-a3760e61.js";import"./refs-f5beb1cc.js";import"./vnode-deac4662.js";import"./position-fe81a45d.js";const ye=(n,E)=>k({url:`/admin/product/baseTrademark/${n}/${E}`,method:"GET"}),Te=n=>n.id?k({url:"/admin/product/baseTrademark/update",method:"PUT",data:n}):k({url:"/admin/product/baseTrademark/save",method:"POST",data:n}),xe=n=>k({url:`/admin/product/baseTrademark/remove/${n}`,method:"DELETE"}),Ne={class:"dialog-footer"},Pe=Y({__name:"index",setup(n){const E=Z(),d=s(1),U=s(3),x=s(0),y=s([]),N=s([]),p=async(l=1)=>{d.value=l;const e=await ye(d.value,U.value);e.code===200&&(x.value=e.data.total,y.value=e.data.records,N.value=e.data.records.map(c=>c.logoUrl))};ee(()=>{p()});const I=l=>{p(l)},L=()=>{p()},i=s(!1),r=s({id:void 0,tmName:"",logoUrl:""});let _=s(null);const z=s({tmName:[{required:!0,message:"请输入品牌名",trigger:"blur"}],logoUrl:[{required:!0,trigger:"change",validator:(l,e,c)=>{e?c():c(new Error("请上传品牌LOGO"))}}]}),S=()=>{i.value=!0,r.value={id:void 0,tmName:"",logoUrl:""},V(()=>{_.value.clearValidate()})},F=l=>{V(()=>{_.value.clearValidate()}),i.value=!0,r.value={id:l.id,tmName:l.tmName,logoUrl:l.logoUrl}},O=()=>{i.value=!1},$=async()=>{await _.value.validate();const l=await Te(r.value);l.code===200?(i.value=!1,m.success(l.message),p(d.value)):(m.error(l.message),i.value=!1)},B=async l=>{const e=await xe(l.id);e.code===200?(m.success(e.message),p(y.value.length>1?d.value:d.value-1)):m.error(e.message)},u=s(!1),G=l=>{if(u.value=!0,["image/jpg","image/jpeg","image/png","image/gif"].includes(l.type)){if(l.size/1024/1024>4)return m.error("图片大小不能超过4MB!"),u.value=!1,!1}else return m.error("图片必须是JPG|PNG|GIF格式!"),u.value=!1,!1;return!0},A=(l,e)=>{u.value=!1,r.value.logoUrl=l.data,_.value.clearValidate("logoUrl")};return(l,e)=>{const c=Ue,f=ke,g=fe,P=Ee,D=ve,j=ge,q=_e,M=se,R=ne,h=de,J=ae("Plus"),Q=ie,H=pe,K=ue,W=me,w=be;return b(),le("div",null,[a(M,null,{default:o(()=>[oe(E).buttons.includes("btn.Trademark.add")?(b(),T(f,{key:0,type:"primary",onClick:S},{default:o(()=>[a(c),v(" 添加品牌 ")]),_:1})):te("",!0),a(j,{data:y.value,border:"",style:{margin:"10px 0"}},{default:o(()=>[a(g,{prop:"id",label:"序号",width:"80px",align:"center",type:"index"}),a(g,{prop:"tmName",label:"品牌名称"}),a(g,{prop:"logoUrl",label:"品牌LOGO"},{default:o(({row:t})=>[a(P,{style:{width:"60px",height:"60px"},fit:"scale-down",src:t.logoUrl,"preview-src-list":N.value,"preview-teleported":!0},null,8,["src","preview-src-list"])]),_:1}),a(g,{prop:"address",label:"品牌操作",width:"165px"},{default:o(({row:t})=>[a(f,{type:"primary",size:"small",icon:"Edit",onClick:X=>F(t)},{default:o(()=>[v("编辑")]),_:2},1032,["onClick"]),a(D,{title:`确定要删除 ${t.tmName} 吗?`,icon:"DeleteFilled","icon-color":"#f56c6c",onConfirm:X=>B(t)},{reference:o(()=>[a(f,{type:"danger",size:"small",icon:"Delete"},{default:o(()=>[v("删除")]),_:1})]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"]),a(q,{"current-page":d.value,"onUpdate:currentPage":e[0]||(e[0]=t=>d.value=t),"page-size":U.value,"onUpdate:pageSize":e[1]||(e[1]=t=>U.value=t),"page-sizes":[3,5,10,30],background:!0,layout:"prev, pager, next, jumper, ->, sizes, total",total:x.value,onSizeChange:L,onCurrentChange:I},null,8,["current-page","page-size","total"])]),_:1}),a(W,{modelValue:i.value,"onUpdate:modelValue":e[3]||(e[3]=t=>i.value=t),title:r.value.id?"修改品牌":"添加品牌",width:"40%"},{footer:o(()=>[re("span",Ne,[a(f,{icon:"CloseBold",onClick:O},{default:o(()=>[v("取消")]),_:1}),a(f,{type:"primary",icon:"Select",onClick:$},{default:o(()=>[v("确认")]),_:1})])]),default:o(()=>[a(K,{"label-width":"100px",model:r.value,rules:z.value,ref_key:"trademarkFormRef",ref:_},{default:o(()=>[a(h,{label:"品牌名称",prop:"tmName"},{default:o(()=>[a(R,{placeholder:"请输入品牌名称",modelValue:r.value.tmName,"onUpdate:modelValue":e[2]||(e[2]=t=>r.value.tmName=t),"prefix-icon":"EditPen"},null,8,["modelValue"])]),_:1}),a(h,{label:"品牌LOGO",disabled:!0,prop:"logoUrl"},{default:o(()=>[a(H,{class:"avatar-uploader",action:"/api/admin/product/fileUpload","show-file-list":!1,"on-success":A,"before-upload":G,disabled:u.value},{default:o(()=>[r.value.logoUrl?C((b(),T(P,{key:0,src:r.value.logoUrl,class:"avatar",fit:"scale-down"},null,8,["src"])),[[w,u.value]]):C((b(),T(Q,{key:1,class:"avatar-uploader-icon"},{default:o(()=>[a(J)]),_:1})),[[w,u.value]])]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});const je=ce(Pe,[["__scopeId","data-v-52d011ff"]]);export{je as default};
